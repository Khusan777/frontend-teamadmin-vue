{"remainingRequest":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/colleagues/SalariesIndex.vue?vue&type=template&id=33813683","dependencies":[{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/colleagues/SalariesIndex.vue","mtime":1647492207775},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlRWxlbWVudFZOb2RlIGFzIF9jcmVhdGVFbGVtZW50Vk5vZGUsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgcmVzb2x2ZUR5bmFtaWNDb21wb25lbnQgYXMgX3Jlc29sdmVEeW5hbWljQ29tcG9uZW50LCBub3JtYWxpemVQcm9wcyBhcyBfbm9ybWFsaXplUHJvcHMsIGd1YXJkUmVhY3RpdmVQcm9wcyBhcyBfZ3VhcmRSZWFjdGl2ZVByb3BzLCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrLCBtZXJnZVByb3BzIGFzIF9tZXJnZVByb3BzLCBjcmVhdGVDb21tZW50Vk5vZGUgYXMgX2NyZWF0ZUNvbW1lbnRWTm9kZSwgRnJhZ21lbnQgYXMgX0ZyYWdtZW50LCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jayB9IGZyb20gInZ1ZSI7Cgp2YXIgX2hvaXN0ZWRfMSA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJoMSIsIHsKICBjbGFzczogInRleHQtMnhsIGZvbnQtYm9sZCIKfSwgItCX0LDRgNC/0LvQsNGC0YsiLCAtMQovKiBIT0lTVEVEICovCik7Cgp2YXIgX2hvaXN0ZWRfMiA9IHsKICBjbGFzczogIm10LTQgbWItNiIKfTsKdmFyIF9ob2lzdGVkXzMgPSB7CiAgY2xhc3M6ICJtdC0yIGZsZXgganVzdGlmeS1lbmQiCn07CmV4cG9ydCBmdW5jdGlvbiByZW5kZXIoX2N0eCwgX2NhY2hlLCAkcHJvcHMsICRzZXR1cCwgJGRhdGEsICRvcHRpb25zKSB7CiAgdmFyIF8kc2V0dXAkZGF0YUxpc3RWYWx1ZSwgXyRzZXR1cCR0YWJDb21wb25lbnRzLCBfJHNldHVwJHRhYkNvbXBvbmVudHMyLCBfJHNldHVwJGluZGV4UGFnaW5hdGksIF8kc2V0dXAkaW5kZXhQYWdpbmF0aTI7CgogIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soX0ZyYWdtZW50LCBudWxsLCBbX2hvaXN0ZWRfMSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMiwgW19jcmVhdGVWTm9kZSgkc2V0dXBbIkF0VGFicyJdLCB7CiAgICBpdGVtczogW3sKICAgICAgdGl0bGU6ICfQmNGB0YLQvtGA0LjRjyDQt9Cw0YDQv9C70LDRgtGLJywKICAgICAgdmFsdWU6ICdoaXN0b3J5JywKICAgICAgaWNvbjogJ2hvbWUnLAogICAgICBleGFjdDogdHJ1ZQogICAgfSwgewogICAgICB0aXRsZTogJ9CX0LDQv9C70LDQvdC40YDQvtCy0LDQvdC90LDRjyDQt9Cw0YDQv9C70LDRgtCwJywKICAgICAgdmFsdWU6ICdzY2hlZHVsZWQnLAogICAgICBpY29uOiAnY2xpcGJvYXJkTGlzdCcKICAgIH1dLAogICAgIm1vZGVsLXZhbHVlIjogX2N0eC4kcm91dGUucXVlcnkudGFiLAogICAgIm9uVXBkYXRlOm1vZGVsVmFsdWUiOiBfY2FjaGVbMF0gfHwgKF9jYWNoZVswXSA9IGZ1bmN0aW9uICgkZXZlbnQpIHsKICAgICAgcmV0dXJuIF9jdHguJHJvdXRlci5wdXNoKHsKICAgICAgICBwYXRoOiBfY3R4LiRyb3V0ZS5wYXRoLAogICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICB0YWI6ICRldmVudAogICAgICAgIH0KICAgICAgfSk7CiAgICB9KQogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJtb2RlbC12YWx1ZSJdKV0pLCAoXyRzZXR1cCRkYXRhTGlzdFZhbHVlID0gJHNldHVwLmRhdGFMaXN0VmFsdWUpICE9PSBudWxsICYmIF8kc2V0dXAkZGF0YUxpc3RWYWx1ZSAhPT0gdm9pZCAwICYmIF8kc2V0dXAkZGF0YUxpc3RWYWx1ZS5sZW5ndGggfHwgJHNldHVwLmFycmF5RmlsbC5sZW5ndGggPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soX3Jlc29sdmVEeW5hbWljQ29tcG9uZW50KCgoXyRzZXR1cCR0YWJDb21wb25lbnRzID0gJHNldHVwLnRhYkNvbXBvbmVudHNbJHNldHVwLnJvdXRlLnF1ZXJ5LnRhYl0pID09PSBudWxsIHx8IF8kc2V0dXAkdGFiQ29tcG9uZW50cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogXyRzZXR1cCR0YWJDb21wb25lbnRzLmNvbXBvbmVudCkgfHwgJHNldHVwLnRhYkNvbXBvbmVudHMuaGlzdG9yeS5jb21wb25lbnQpLCBfbm9ybWFsaXplUHJvcHMoX21lcmdlUHJvcHMoewogICAga2V5OiAwCiAgfSwgKChfJHNldHVwJHRhYkNvbXBvbmVudHMyID0gJHNldHVwLnRhYkNvbXBvbmVudHNbJHNldHVwLnJvdXRlLnF1ZXJ5LnRhYl0pID09PSBudWxsIHx8IF8kc2V0dXAkdGFiQ29tcG9uZW50czIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF8kc2V0dXAkdGFiQ29tcG9uZW50czIucHJvcHMpIHx8ICRzZXR1cC50YWJDb21wb25lbnRzLmhpc3RvcnkucHJvcHMpKSwgbnVsbCwgMTYKICAvKiBGVUxMX1BST1BTICovCiAgKSkgOiBfY3JlYXRlQ29tbWVudFZOb2RlKCJ2LWlmIiwgdHJ1ZSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIF9ob2lzdGVkXzMsIFsoKF8kc2V0dXAkaW5kZXhQYWdpbmF0aSA9ICRzZXR1cC5pbmRleFBhZ2luYXRpb24ubWV0YSkgPT09IG51bGwgfHwgXyRzZXR1cCRpbmRleFBhZ2luYXRpID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfJHNldHVwJGluZGV4UGFnaW5hdGkubGFzdF9wYWdlKSA+IDEgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soJHNldHVwWyJBdFBhZ2luYXRpb24iXSwgewogICAga2V5OiAwLAogICAgY2xhc3M6ICJweS00IG1kOmNvbC1zcGFuLTEiLAogICAgbW9kZWxWYWx1ZTogJHNldHVwLnF1ZXJ5MS5wYWdlLAogICAgIm9uVXBkYXRlOm1vZGVsVmFsdWUiOiBfY2FjaGVbMV0gfHwgKF9jYWNoZVsxXSA9IGZ1bmN0aW9uICgkZXZlbnQpIHsKICAgICAgcmV0dXJuICRzZXR1cC5xdWVyeTEucGFnZSA9ICRldmVudDsKICAgIH0pLAogICAgdG90YWw6IChfJHNldHVwJGluZGV4UGFnaW5hdGkyID0gJHNldHVwLmluZGV4UGFnaW5hdGlvbi5tZXRhKSA9PT0gbnVsbCB8fCBfJHNldHVwJGluZGV4UGFnaW5hdGkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfJHNldHVwJGluZGV4UGFnaW5hdGkyLmxhc3RfcGFnZQogIH0sIG51bGwsIDgKICAvKiBQUk9QUyAqLwogICwgWyJtb2RlbFZhbHVlIiwgInRvdGFsIl0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKV0pXSwgNjQKICAvKiBTVEFCTEVfRlJBR01FTlQgKi8KICApOwp9"},{"version":3,"sources":["/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/colleagues/SalariesIndex.vue"],"names":[],"mappings":";;8BAyIE,mBAAA,CAA4C,IAA5C,EAA4C;AAAxC,EAAA,KAAK,EAAC;AAAkC,CAA5C,EAA+B,UAA/B,EAAuC,CAAA;AAAA;AAAvC,C;;;AACK,EAAA,KAAK,EAAC;;;AAeN,EAAA,KAAK,EAAC;;;;;6DAhBX,U,EACA,mBAAA,CASM,KATN,EAAA,UAAA,EASM,CARJ,YAAA,CAOE,MAAA,CAAA,QAAA,CAPF,EAOE;AANC,IAAA,KAAK,EAAE,C;;;;;KAAA,E;;;;KAAA,CAMR;AAFC,mBAAa,IAAA,CAAA,MAAA,CAAO,KAAP,CAAa,GAE3B;AADC,2BAAkB,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA,UAAA,MAAA;AAAA,aAAE,IAAA,CAAA,OAAA,CAAQ,IAAR,CAAY;AAAA,QAAA,IAAA,EAAS,IAAA,CAAA,MAAA,CAAO,IAAhB;AAAoB,QAAA,KAAA,EAAA;AAAA,UAAA,GAAA,EAAgB;AAAhB;AAApB,OAAZ,CAAF;AAAA,KAAA;AACnB,GAPF,E,IAAA,E;;AAAA,I,eAAA,CAQI,CATN,C,EAWQ,yBAAA,MAAA,CAAA,aAAA,wEAAe,MAAf,IAAyB,MAAA,CAAA,SAAA,CAAU,M,kBAD3C,YAAA,CAIa,wBAAA,CAFN,0BAAA,MAAA,CAAA,aAAA,CAAc,MAAA,CAAA,KAAA,CAAM,KAAN,CAAY,GAA1B,iFAAgC,SAAhC,KAA6C,MAAA,CAAA,aAAA,CAAc,OAAd,CAAsB,SAE7D,CAJb,EAEmF,eAAA,CAAA,WAAA,CAAA;AAAA,IAAA,GAAA,EAAA;AAAA,GAAA,EACzE,2BAAA,MAAA,CAAA,aAAA,CAAc,MAAA,CAAA,KAAA,CAAM,KAAN,CAAY,GAA1B,mFAAgC,KAAhC,KAAyC,MAAA,CAAA,aAAA,CAAc,OAAd,CAAsB,KADU,CAAA,CAFnF,EAG8E,IAH9E,EAG8E;AAAA;AAH9E,G,uCAKA,mBAAA,CAOM,KAPN,EAAA,UAAA,EAOM,CALI,0BAAA,MAAA,CAAA,eAAA,CAAgB,IAAhB,gFAAsB,SAAtB,IAA+B,C,kBADvC,YAAA,CAKiB,MAAA,CAAA,cAAA,CALjB,EAKiB;UAAA;AAHf,IAAA,KAAK,EAAC,oBAGS;gBAFN,MAAA,CAAA,MAAA,CAAO,IAED;;aAFN,MAAA,CAAA,MAAA,CAAO,IAAP,GAAW,M;MAEL;AADd,IAAA,KAAK,4BAAE,MAAA,CAAA,eAAA,CAAgB,IAAlB,2DAAE,uBAAsB;AACf,GALjB,E,IAAA,E;;AAAA,I,uBAAA,C,qCAMI,CAPN,C","sourcesContent":["<script>\n  export default {\n    beforeRouteEnter(to, from, next) {\n      if (!to.query.tab) return next({ path: to.path, query: { tab: 'history' } });\n      next();\n    },\n  };\n</script>\n\n<script setup>\n  import { useRoute } from 'vue-router';\n  import { computed, defineAsyncComponent, watch, onMounted, ref, watchEffect } from 'vue';\n  import { deepCopy } from '~/plugins/aliftech-ui/utils';\n  import { getAllColleagues } from '~/services/colleagues.api';\n  import useRouterReplace from '~/utils/hooks/useRouterReplace';\n  import { getAllSalaries } from '~/services/salaries.api';\n  import { $toast } from '~/main';\n  const AtPagination = defineAsyncComponent(() =>\n    import('~/plugins/aliftech-ui/components/AtPagination/AtPagination.js')\n  );\n  const HistorySalaries = defineAsyncComponent(() => import('~/components/salaries/HistorySalaries.vue'));\n  const AtTabs = defineAsyncComponent(() => import('~/plugins/aliftech-ui/components/AtTabs/AtTabs.js'));\n  const ScheduleSalaries = defineAsyncComponent(() => import('~/components/salaries/ScheduleSalaries.vue'));\n  const colleagues = ref([]);\n  const salariesActual = ref([]);\n  const salariesSchedule = ref([]);\n  const indexPagination = ref({});\n  const dataListValue = ref('');\n  const loading = ref(false);\n  const routerReplace = useRouterReplace();\n  const route = useRoute();\n  const arrayFill = ref(Array(1).fill(1));\n  const query1 = ref({\n    search: route.query.search || '',\n    department_id: route.query.department_id || '',\n    team_id: route.query.team_id || '',\n    page: route.query.page || '',\n    per_page: 15,\n  });\n\n  const getColleagues = async () => {\n    loading.value = true;\n    window.scrollTo(0, 0);\n    await getAllColleagues(query1.value)\n      .then(response => {\n        colleagues.value = response?.data?.data;\n        indexPagination.value = response?.data;\n        dataListValue.value = colleagues.value?.map(item => item.id).join(',');\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n    if (route.query.tab == 'history') {\n      getIndexSalariesActual();\n    } else {\n      getIndexSalariesSchedule();\n    }\n  };\n\n  const getIndexSalariesActual = async () => {\n    loading.value = true;\n    await getAllSalaries({ employee_ids: dataListValue.value, status: 'actual' })\n      .then(response => {\n        salariesActual.value = response.data?.data;\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n  };\n\n  const getIndexSalariesSchedule = async () => {\n    loading.value = true;\n    await getAllSalaries({ employee_ids: dataListValue.value, status: 'scheduled' })\n      .then(response => {\n        salariesSchedule.value = response.data?.data;\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n  };\n\n  onMounted(() => {\n    getColleagues();\n  });\n\n  watch(\n    () => route.query,\n    /**\n     * Fetch the user information when query change\n     * @param {Object} newQueryValue - Query object\n     */\n    newQueryValue => {\n      query1.value = deepCopy(newQueryValue);\n      getColleagues();\n    }\n  );\n\n  watchEffect(() => {\n    routerReplace.setRouter(query1);\n  });\n\n  const tabComponents = computed(() => ({\n    history: {\n      component: HistorySalaries,\n      props: {\n        loading: loading.value,\n        indexPagination: indexPagination.value,\n        colleagues: colleagues.value,\n        dataListValue: dataListValue.value,\n        salaries: salariesActual.value,\n        arrayFill: arrayFill.value,\n      },\n    },\n    scheduled: {\n      component: ScheduleSalaries,\n      props: {\n        loading: loading.value,\n        indexPagination: indexPagination.value,\n        colleagues: colleagues.value,\n        dataListValue: dataListValue.value,\n        salaries: salariesSchedule.value,\n        arrayFill: arrayFill.value,\n      },\n    },\n  }));\n</script>\n\n<template>\n  <h1 class=\"text-2xl font-bold\">Зарплаты</h1>\n  <div class=\"mt-4 mb-6\">\n    <AtTabs\n      :items=\"[\n        { title: 'История зарплаты', value: 'history', icon: 'home', exact: true },\n        { title: 'Запланированная зарплата', value: 'scheduled', icon: 'clipboardList' },\n      ]\"\n      :model-value=\"$route.query.tab\"\n      @update:model-value=\"$router.push({ path: $route.path, query: { tab: $event } })\"\n    />\n  </div>\n  <component\n    v-if=\"dataListValue?.length || arrayFill.length\"\n    :is=\"tabComponents[route.query.tab]?.component || tabComponents.history.component\"\n    v-bind=\"tabComponents[route.query.tab]?.props || tabComponents.history.props\"\n  ></component>\n  <div class=\"mt-2 flex justify-end\">\n    <at-pagination\n      v-if=\"indexPagination.meta?.last_page > 1\"\n      class=\"py-4 md:col-span-1\"\n      v-model=\"query1.page\"\n      :total=\"indexPagination.meta?.last_page\"\n    ></at-pagination>\n  </div>\n</template>\n\n<style scoped></style>\n"],"sourceRoot":""}]}