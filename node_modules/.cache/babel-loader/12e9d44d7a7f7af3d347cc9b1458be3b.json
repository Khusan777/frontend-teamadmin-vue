{"remainingRequest":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/eslint-loader/index.js??ref--13-0!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/services/auth/auth.api.js","dependencies":[{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/services/auth/auth.api.js","mtime":1649844186513},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2FkbWluL0Rlc2t0b3AvTXlQcm9qZWN0cy9mcm9udGVuZC10ZWFtYWRtaW4tdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IGFwaUNsaWVudCwgY2xlYXJDb29raWUgfSBmcm9tICd+L3NlcnZpY2VzL2F1dGgvYXBpQ2xpZW50JzsKaW1wb3J0IHsgYXBwIH0gZnJvbSAnfi9tYWluJzsKaW1wb3J0IHsgb2JqQ2hlY2tUeXBlIH0gZnJvbSAnfi91dGlscy9jb21wdXRlRnVuYyc7CmltcG9ydCBzdG9yZSBmcm9tICd+L3N0b3JlJzsKdmFyIEVORF9QT0lOVCA9ICcvYXV0aCc7Ci8qKg0KICogU2V0IGF1dGhlbnRpY2F0aW9uIHNldHRpbmcgYWZ0ZXIgbG9naW4NCiAqIEBwYXJhbSB7T2JqZWN0fSByZXMNCiAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVtZW1iZXJNZQ0KICogQHJldHVybnMgeyp9DQogKi8KCnZhciBzZXRBdXRoID0gZnVuY3Rpb24gc2V0QXV0aChyZXMsIHJlbWVtYmVyTWUpIHsKICB2YXIgX2RhdGEkZXhwaXJlc19pbjsKCiAgdmFyIGRhdGEgPSByZXMgPT09IG51bGwgfHwgcmVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXMuZGF0YTsKICB2YXIgYWNjZXNzVG9rZW4gPSBkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRhdGEuYWNjZXNzX3Rva2VuOwogIHZhciB0b2tlblR5cGUgPSBkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRhdGEudG9rZW5fdHlwZTsKICB2YXIgZXhwaXJlc0luID0gKF9kYXRhJGV4cGlyZXNfaW4gPSBkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRhdGEuZXhwaXJlc19pbikgIT09IG51bGwgJiYgX2RhdGEkZXhwaXJlc19pbiAhPT0gdm9pZCAwID8gX2RhdGEkZXhwaXJlc19pbiA6IDE7CiAgdmFyIHRva2VuID0gdG9rZW5UeXBlICsgJyAnICsgYWNjZXNzVG9rZW47CgogIGlmIChvYmpDaGVja1R5cGUoYWNjZXNzVG9rZW4sICdzdHJpbmcnKSAmJiBvYmpDaGVja1R5cGUodG9rZW5UeXBlLCAnc3RyaW5nJykpIHsKICAgIHZhciBfYXBwJGNvbmZpZyRnbG9iYWxQcm87CgogICAgdmFyICRjb29raWUgPSAoX2FwcCRjb25maWckZ2xvYmFsUHJvID0gYXBwLmNvbmZpZy5nbG9iYWxQcm9wZXJ0aWVzKSA9PT0gbnVsbCB8fCBfYXBwJGNvbmZpZyRnbG9iYWxQcm8gPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hcHAkY29uZmlnJGdsb2JhbFByby4kY29va2llOwoKICAgIGlmICgkY29va2llKSB7CiAgICAgIGNsZWFyQ29va2llKCkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgJGNvb2tpZS5zZXQoJ2F1dGgnLCB0b2tlbiwgewogICAgICAgICAgZXhwaXJlczogcmVtZW1iZXJNZSA/ICIiLmNvbmNhdChleHBpcmVzSW4sICJzIikgOiAnMUQnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBhcGlDbGllbnQuZGVmYXVsdHMuaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gdG9rZW47CiAgICB9CiAgfQoKICByZXR1cm4gcmVzOwp9OwoKdmFyIGdldFVzZXIgPSBmdW5jdGlvbiBnZXRVc2VyKCkgewogIHJldHVybiBhcGlDbGllbnQuZ2V0KCIiLmNvbmNhdChFTkRfUE9JTlQsICIvdXNlciIpLCB7CiAgICBwYXJhbXM6IHsKICAgICAgYXBwOiAnQWRtaW4nCiAgICB9CiAgfSk7Cn07Ci8qKg0KICogU2V0IGF1dGhvcml6YXRpb24gbG9naW4gdXNlcg0KICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyAtIFJlcXVlc3QgcGFyYW1zDQogKiBAcGFyYW0ge2Jvb2xlYW59IHJlbWVtYmVyTWUNCiAqIEByZXR1cm5zIHtQcm9taXNlPCo+fQ0KICovCgoKdmFyIGxvZ2luID0gZnVuY3Rpb24gbG9naW4ocGFyYW1zKSB7CiAgcmV0dXJuIGFwaUNsaWVudC5wb3N0KCIiLmNvbmNhdChFTkRfUE9JTlQsICIvbG9naW4tcGFzc3dvcmQiKSwgX29iamVjdFNwcmVhZCh7CiAgICByZW1lbWJlcl9tZTogdHJ1ZQogIH0sIHBhcmFtcykpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICBzZXRBdXRoKHJlc3BvbnNlLCBwYXJhbXMucmVtZW1iZXJfbWUpOwogICAgc3RvcmUuZGlzcGF0Y2goJ2F1dGgvZ2V0VXNlcicpOwogIH0pOwp9OwoKZXhwb3J0IHsgbG9naW4sIGdldFVzZXIgfTs="},{"version":3,"sources":["/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/services/auth/auth.api.js"],"names":["apiClient","clearCookie","app","objCheckType","store","END_POINT","setAuth","res","rememberMe","data","accessToken","access_token","tokenType","token_type","expiresIn","expires_in","token","$cookie","config","globalProperties","finally","set","expires","defaults","headers","getUser","get","params","login","post","remember_me","then","response","dispatch"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,WAApB,QAAuC,2BAAvC;AACA,SAASC,GAAT,QAAoB,QAApB;AACA,SAASC,YAAT,QAA6B,qBAA7B;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,IAAMC,SAAS,GAAG,OAAlB;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,GAAD,EAAMC,UAAN,EAAqB;AAAA;;AACnC,MAAMC,IAAI,GAAGF,GAAH,aAAGA,GAAH,uBAAGA,GAAG,CAAEE,IAAlB;AACA,MAAMC,WAAW,GAAGD,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEE,YAA1B;AACA,MAAMC,SAAS,GAAGH,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEI,UAAxB;AACA,MAAMC,SAAS,uBAAGL,IAAH,aAAGA,IAAH,uBAAGA,IAAI,CAAEM,UAAT,+DAAuB,CAAtC;AACA,MAAMC,KAAK,GAAGJ,SAAS,GAAG,GAAZ,GAAkBF,WAAhC;;AAEA,MAAIP,YAAY,CAACO,WAAD,EAAc,QAAd,CAAZ,IAAuCP,YAAY,CAACS,SAAD,EAAY,QAAZ,CAAvD,EAA8E;AAAA;;AAC5E,QAAMK,OAAO,4BAAGf,GAAG,CAACgB,MAAJ,CAAWC,gBAAd,0DAAG,sBAA6BF,OAA7C;;AACA,QAAIA,OAAJ,EAAa;AACXhB,MAAAA,WAAW,GAAGmB,OAAd,CAAsB,YAAM;AAC1BH,QAAAA,OAAO,CAACI,GAAR,CAAY,MAAZ,EAAoBL,KAApB,EAA2B;AACzBM,UAAAA,OAAO,EAAEd,UAAU,aAAMM,SAAN,SAAqB;AADf,SAA3B;AAGD,OAJD;AAKAd,MAAAA,SAAS,CAACuB,QAAV,CAAmBC,OAAnB,CAA2B,eAA3B,IAA8CR,KAA9C;AACD;AACF;;AACD,SAAOT,GAAP;AACD,CAnBD;;AAqBA,IAAMkB,OAAO,GAAG,SAAVA,OAAU;AAAA,SAAMzB,SAAS,CAAC0B,GAAV,WAAiBrB,SAAjB,YAAmC;AAAEsB,IAAAA,MAAM,EAAE;AAAEzB,MAAAA,GAAG,EAAE;AAAP;AAAV,GAAnC,CAAN;AAAA,CAAhB;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAEA,IAAM0B,KAAK,GAAG,SAARA,KAAQ,CAAAD,MAAM;AAAA,SAClB3B,SAAS,CAAC6B,IAAV,WAAkBxB,SAAlB;AAAgDyB,IAAAA,WAAW,EAAE;AAA7D,KAAsEH,MAAtE,GAAgFI,IAAhF,CAAqF,UAAAC,QAAQ,EAAI;AAC/F1B,IAAAA,OAAO,CAAC0B,QAAD,EAAWL,MAAM,CAACG,WAAlB,CAAP;AACA1B,IAAAA,KAAK,CAAC6B,QAAN,CAAe,cAAf;AACD,GAHD,CADkB;AAAA,CAApB;;AAMA,SAASL,KAAT,EAAgBH,OAAhB","sourcesContent":["import { apiClient, clearCookie } from '~/services/auth/apiClient';\r\nimport { app } from '~/main';\r\nimport { objCheckType } from '~/utils/computeFunc';\r\nimport store from '~/store';\r\n\r\nconst END_POINT = '/auth';\r\n\r\n/**\r\n * Set authentication setting after login\r\n * @param {Object} res\r\n * @param {boolean} rememberMe\r\n * @returns {*}\r\n */\r\n\r\nconst setAuth = (res, rememberMe) => {\r\n  const data = res?.data;\r\n  const accessToken = data?.access_token;\r\n  const tokenType = data?.token_type;\r\n  const expiresIn = data?.expires_in ?? 1;\r\n  const token = tokenType + ' ' + accessToken;\r\n\r\n  if (objCheckType(accessToken, 'string') && objCheckType(tokenType, 'string')) {\r\n    const $cookie = app.config.globalProperties?.$cookie;\r\n    if ($cookie) {\r\n      clearCookie().finally(() => {\r\n        $cookie.set('auth', token, {\r\n          expires: rememberMe ? `${expiresIn}s` : '1D',\r\n        });\r\n      });\r\n      apiClient.defaults.headers['Authorization'] = token;\r\n    }\r\n  }\r\n  return res;\r\n};\r\n\r\nconst getUser = () => apiClient.get(`${END_POINT}/user`, { params: { app: 'Admin' } });\r\n\r\n/**\r\n * Set authorization login user\r\n * @param {Object} params - Request params\r\n * @param {boolean} rememberMe\r\n * @returns {Promise<*>}\r\n */\r\n\r\nconst login = params =>\r\n  apiClient.post(`${END_POINT}/login-password`, { remember_me: true, ...params }).then(response => {\r\n    setAuth(response, params.remember_me);\r\n    store.dispatch('auth/getUser');\r\n  });\r\n\r\nexport { login, getUser };\r\n"]}]}