{"remainingRequest":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/salaries/SalariesIndex.vue?vue&type=template&id=731f05c7","dependencies":[{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/salaries/SalariesIndex.vue","mtime":1647964825741},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlRWxlbWVudFZOb2RlIGFzIF9jcmVhdGVFbGVtZW50Vk5vZGUsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgcmVzb2x2ZUR5bmFtaWNDb21wb25lbnQgYXMgX3Jlc29sdmVEeW5hbWljQ29tcG9uZW50LCBub3JtYWxpemVQcm9wcyBhcyBfbm9ybWFsaXplUHJvcHMsIGd1YXJkUmVhY3RpdmVQcm9wcyBhcyBfZ3VhcmRSZWFjdGl2ZVByb3BzLCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrLCBtZXJnZVByb3BzIGFzIF9tZXJnZVByb3BzLCBjcmVhdGVDb21tZW50Vk5vZGUgYXMgX2NyZWF0ZUNvbW1lbnRWTm9kZSwgRnJhZ21lbnQgYXMgX0ZyYWdtZW50LCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jayB9IGZyb20gInZ1ZSI7Cgp2YXIgX2hvaXN0ZWRfMSA9IC8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCB7CiAgY2xhc3M6ICItbS02IG1iLTQiCn0sIFsvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgewogIGNsYXNzOiAidy1mdWxsIGJnLWFscGhhIgp9LCBbLyojX19QVVJFX18qL19jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIHsKICBjbGFzczogImZsZXggaXRlbXMtY2VudGVyIHAtNCBib3JkZXItYiIKfSwgWy8qI19fUFVSRV9fKi9fY3JlYXRlRWxlbWVudFZOb2RlKCJoMSIsIHsKICBjbGFzczogInRleHQtMnhsIGZvbnQtYm9sZCBweC0zIgp9LCAi0JfQsNGA0L/Qu9Cw0YLRiyIpXSldKV0sIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF8yID0gewogIGNsYXNzOiAibXQtNCBtYi02Igp9Owp2YXIgX2hvaXN0ZWRfMyA9IHsKICBjbGFzczogIm10LTIgZmxleCBqdXN0aWZ5LWVuZCIKfTsKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgXyRzZXR1cCRkYXRhTGlzdFZhbHVlLCBfJHNldHVwJHRhYkNvbXBvbmVudHMsIF8kc2V0dXAkdGFiQ29tcG9uZW50czIsIF8kc2V0dXAkaW5kZXhQYWdpbmF0aSwgXyRzZXR1cCRpbmRleFBhZ2luYXRpMjsKCiAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jayhfRnJhZ21lbnQsIG51bGwsIFtfaG9pc3RlZF8xLCBfY3JlYXRlRWxlbWVudFZOb2RlKCJkaXYiLCBfaG9pc3RlZF8yLCBbX2NyZWF0ZVZOb2RlKCRzZXR1cFsiQXRUYWJzIl0sIHsKICAgIGl0ZW1zOiBbewogICAgICB0aXRsZTogJ9CY0YHRgtC+0YDQuNGPINC30LDRgNC/0LvQsNGC0YsnLAogICAgICB2YWx1ZTogJ2hpc3RvcnknLAogICAgICBpY29uOiAnaG9tZScsCiAgICAgIGV4YWN0OiB0cnVlCiAgICB9LCB7CiAgICAgIHRpdGxlOiAn0JfQsNC/0LvQsNC90LjRgNC+0LLQsNC90L3QsNGPINC30LDRgNC/0LvQsNGC0LAnLAogICAgICB2YWx1ZTogJ3NjaGVkdWxlZCcsCiAgICAgIGljb246ICdjbGlwYm9hcmRMaXN0JwogICAgfV0sCiAgICAibW9kZWwtdmFsdWUiOiBfY3R4LiRyb3V0ZS5xdWVyeS50YWIsCiAgICAib25VcGRhdGU6bW9kZWxWYWx1ZSI6IF9jYWNoZVswXSB8fCAoX2NhY2hlWzBdID0gZnVuY3Rpb24gKCRldmVudCkgewogICAgICByZXR1cm4gX2N0eC4kcm91dGVyLnB1c2goewogICAgICAgIHBhdGg6IF9jdHguJHJvdXRlLnBhdGgsCiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIHRhYjogJGV2ZW50CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pCiAgfSwgbnVsbCwgOAogIC8qIFBST1BTICovCiAgLCBbIm1vZGVsLXZhbHVlIl0pXSksIChfJHNldHVwJGRhdGFMaXN0VmFsdWUgPSAkc2V0dXAuZGF0YUxpc3RWYWx1ZSkgIT09IG51bGwgJiYgXyRzZXR1cCRkYXRhTGlzdFZhbHVlICE9PSB2b2lkIDAgJiYgXyRzZXR1cCRkYXRhTGlzdFZhbHVlLmxlbmd0aCB8fCAkc2V0dXAuYXJyYXlGaWxsLmxlbmd0aCA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVCbG9jayhfcmVzb2x2ZUR5bmFtaWNDb21wb25lbnQoKChfJHNldHVwJHRhYkNvbXBvbmVudHMgPSAkc2V0dXAudGFiQ29tcG9uZW50c1skc2V0dXAucm91dGUucXVlcnkudGFiXSkgPT09IG51bGwgfHwgXyRzZXR1cCR0YWJDb21wb25lbnRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfJHNldHVwJHRhYkNvbXBvbmVudHMuY29tcG9uZW50KSB8fCAkc2V0dXAudGFiQ29tcG9uZW50cy5oaXN0b3J5LmNvbXBvbmVudCksIF9ub3JtYWxpemVQcm9wcyhfbWVyZ2VQcm9wcyh7CiAgICBrZXk6IDAKICB9LCAoKF8kc2V0dXAkdGFiQ29tcG9uZW50czIgPSAkc2V0dXAudGFiQ29tcG9uZW50c1skc2V0dXAucm91dGUucXVlcnkudGFiXSkgPT09IG51bGwgfHwgXyRzZXR1cCR0YWJDb21wb25lbnRzMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogXyRzZXR1cCR0YWJDb21wb25lbnRzMi5wcm9wcykgfHwgJHNldHVwLnRhYkNvbXBvbmVudHMuaGlzdG9yeS5wcm9wcykpLCBudWxsLCAxNgogIC8qIEZVTExfUFJPUFMgKi8KICApKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKSwgX2NyZWF0ZUVsZW1lbnRWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfMywgWygoXyRzZXR1cCRpbmRleFBhZ2luYXRpID0gJHNldHVwLmluZGV4UGFnaW5hdGlvbi5tZXRhKSA9PT0gbnVsbCB8fCBfJHNldHVwJGluZGV4UGFnaW5hdGkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF8kc2V0dXAkaW5kZXhQYWdpbmF0aS5sYXN0X3BhZ2UpID4gMSA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVCbG9jaygkc2V0dXBbIkF0UGFnaW5hdGlvbiJdLCB7CiAgICBrZXk6IDAsCiAgICBjbGFzczogInB5LTQgbWQ6Y29sLXNwYW4tMSIsCiAgICBtb2RlbFZhbHVlOiAkc2V0dXAucXVlcnkxLnBhZ2UsCiAgICAib25VcGRhdGU6bW9kZWxWYWx1ZSI6IF9jYWNoZVsxXSB8fCAoX2NhY2hlWzFdID0gZnVuY3Rpb24gKCRldmVudCkgewogICAgICByZXR1cm4gJHNldHVwLnF1ZXJ5MS5wYWdlID0gJGV2ZW50OwogICAgfSksCiAgICB0b3RhbDogKF8kc2V0dXAkaW5kZXhQYWdpbmF0aTIgPSAkc2V0dXAuaW5kZXhQYWdpbmF0aW9uLm1ldGEpID09PSBudWxsIHx8IF8kc2V0dXAkaW5kZXhQYWdpbmF0aTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF8kc2V0dXAkaW5kZXhQYWdpbmF0aTIubGFzdF9wYWdlCiAgfSwgbnVsbCwgOAogIC8qIFBST1BTICovCiAgLCBbIm1vZGVsVmFsdWUiLCAidG90YWwiXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXSldLCA2NAogIC8qIFNUQUJMRV9GUkFHTUVOVCAqLwogICk7Cn0="},{"version":3,"sources":["/Users/admin/Desktop/MyProjects/frontend-teamadmin-vue/src/pages/salaries/SalariesIndex.vue"],"names":[],"mappings":";;8BAyIE,mBAAA,CAMM,KANN,EAMM;AAND,EAAA,KAAK,EAAC;AAML,CANN,EAAsB,C,aACpB,mBAAA,CAIM,KAJN,EAIM;AAJD,EAAA,KAAK,EAAC;AAIL,CAJN,EAA4B,C,aAC1B,mBAAA,CAEM,KAFN,EAEM;AAFD,EAAA,KAAK,EAAC;AAEL,CAFN,EAA2C,C,aACzC,mBAAA,CAAiD,IAAjD,EAAiD;AAA7C,EAAA,KAAK,EAAC;AAAuC,CAAjD,EAAoC,UAApC,CADyC,CAA3C,CAD0B,CAA5B,CADoB,CAAtB,E;;AAAA,C;;;AAOK,EAAA,KAAK,EAAC;;;AAeN,EAAA,KAAK,EAAC;;;;;6DAtBX,U,EAOA,mBAAA,CASM,KATN,EAAA,UAAA,EASM,CARJ,YAAA,CAOE,MAAA,CAAA,QAAA,CAPF,EAOE;AANC,IAAA,KAAK,EAAE,C;;;;;KAAA,E;;;;KAAA,CAMR;AAFC,mBAAa,IAAA,CAAA,MAAA,CAAO,KAAP,CAAa,GAE3B;AADC,2BAAkB,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA,UAAA,MAAA;AAAA,aAAE,IAAA,CAAA,OAAA,CAAQ,IAAR,CAAY;AAAA,QAAA,IAAA,EAAS,IAAA,CAAA,MAAA,CAAO,IAAhB;AAAoB,QAAA,KAAA,EAAA;AAAA,UAAA,GAAA,EAAgB;AAAhB;AAApB,OAAZ,CAAF;AAAA,KAAA;AACnB,GAPF,E,IAAA,E;;AAAA,I,eAAA,CAQI,CATN,C,EAWQ,yBAAA,MAAA,CAAA,aAAA,wEAAe,MAAf,IAAyB,MAAA,CAAA,SAAA,CAAU,M,kBAD3C,YAAA,CAIa,wBAAA,CAFN,0BAAA,MAAA,CAAA,aAAA,CAAc,MAAA,CAAA,KAAA,CAAM,KAAN,CAAY,GAA1B,iFAAgC,SAAhC,KAA6C,MAAA,CAAA,aAAA,CAAc,OAAd,CAAsB,SAE7D,CAJb,EAEmF,eAAA,CAAA,WAAA,CAAA;AAAA,IAAA,GAAA,EAAA;AAAA,GAAA,EACzE,2BAAA,MAAA,CAAA,aAAA,CAAc,MAAA,CAAA,KAAA,CAAM,KAAN,CAAY,GAA1B,mFAAgC,KAAhC,KAAyC,MAAA,CAAA,aAAA,CAAc,OAAd,CAAsB,KADU,CAAA,CAFnF,EAG8E,IAH9E,EAG8E;AAAA;AAH9E,G,uCAKA,mBAAA,CAOM,KAPN,EAAA,UAAA,EAOM,CALI,0BAAA,MAAA,CAAA,eAAA,CAAgB,IAAhB,gFAAsB,SAAtB,IAA+B,C,kBADvC,YAAA,CAKiB,MAAA,CAAA,cAAA,CALjB,EAKiB;UAAA;AAHf,IAAA,KAAK,EAAC,oBAGS;gBAFN,MAAA,CAAA,MAAA,CAAO,IAED;;aAFN,MAAA,CAAA,MAAA,CAAO,IAAP,GAAW,M;MAEL;AADd,IAAA,KAAK,4BAAE,MAAA,CAAA,eAAA,CAAgB,IAAlB,2DAAE,uBAAsB;AACf,GALjB,E,IAAA,E;;AAAA,I,uBAAA,C,qCAMI,CAPN,C","sourcesContent":["<script>\n  export default {\n    beforeRouteEnter(to, from, next) {\n      if (!to.query.tab) return next({ path: to.path, query: { tab: 'history' } });\n      next();\n    },\n  };\n</script>\n\n<script setup>\n  import { useRoute } from 'vue-router';\n  import { computed, defineAsyncComponent, watch, onMounted, ref, watchEffect } from 'vue';\n  import { deepCopy } from '~/plugins/aliftech-ui/utils';\n  import { getAllColleagues } from '~/services/colleagues.api';\n  import useRouterReplace from '~/utils/hooks/useRouterReplace';\n  import { getAllSalaries } from '~/services/salaries.api';\n  import { $toast } from '~/main';\n  const AtPagination = defineAsyncComponent(() =>\n    import('~/plugins/aliftech-ui/components/AtPagination/AtPagination.js')\n  );\n  const HistorySalaries = defineAsyncComponent(() => import('~/components/salaries/HistorySalaries.vue'));\n  const AtTabs = defineAsyncComponent(() => import('~/plugins/aliftech-ui/components/AtTabs/AtTabs.js'));\n  const ScheduleSalaries = defineAsyncComponent(() => import('~/components/salaries/ScheduleSalaries.vue'));\n  const colleagues = ref([]);\n  const salariesActual = ref([]);\n  const salariesSchedule = ref([]);\n  const indexPagination = ref({});\n  const dataListValue = ref('');\n  const loading = ref(false);\n  const routerReplace = useRouterReplace();\n  const route = useRoute();\n  const arrayFill = ref(Array(1).fill(1));\n  const query1 = ref({\n    search: route.query.search || '',\n    department_id: route.query.department_id || '',\n    team_id: route.query.team_id || '',\n    page: route.query.page || '',\n    per_page: 15,\n  });\n\n  const getColleagues = async () => {\n    loading.value = true;\n    window.scrollTo(0, 0);\n    await getAllColleagues(query1.value)\n      .then(response => {\n        colleagues.value = response?.data?.data;\n        indexPagination.value = response?.data;\n        dataListValue.value = colleagues.value?.map(item => item.id).join(',');\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n    if (route.query.tab == 'history') {\n      getIndexSalariesActual();\n    } else {\n      getIndexSalariesSchedule();\n    }\n  };\n\n  const getIndexSalariesActual = async () => {\n    loading.value = true;\n    await getAllSalaries({ employee_ids: dataListValue.value, status: 'actual' })\n      .then(response => {\n        salariesActual.value = response.data?.data;\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n  };\n\n  const getIndexSalariesSchedule = async () => {\n    loading.value = true;\n    await getAllSalaries({ employee_ids: dataListValue.value, status: 'scheduled' })\n      .then(response => {\n        salariesSchedule.value = response.data?.data;\n      })\n      .catch(error => {\n        if (error) {\n          $toast.show({ title: 'Error', subTitle: error?.response?.data?.message, type: 'error' });\n        }\n      })\n      .finally(() => (loading.value = false));\n  };\n\n  onMounted(() => {\n    getColleagues();\n  });\n\n  watch(\n    () => route.query,\n    /**\n     * Fetch the user information when query change\n     * @param {Object} newQueryValue - Query object\n     */\n    newQueryValue => {\n      query1.value = deepCopy(newQueryValue);\n      getColleagues();\n    }\n  );\n\n  watchEffect(() => {\n    routerReplace.setRouter(query1);\n  });\n\n  const tabComponents = computed(() => ({\n    history: {\n      component: HistorySalaries,\n      props: {\n        loading: loading.value,\n        indexPagination: indexPagination.value,\n        colleagues: colleagues.value,\n        dataListValue: dataListValue.value,\n        salaries: salariesActual.value,\n        arrayFill: arrayFill.value,\n      },\n    },\n    scheduled: {\n      component: ScheduleSalaries,\n      props: {\n        loading: loading.value,\n        indexPagination: indexPagination.value,\n        colleagues: colleagues.value,\n        dataListValue: dataListValue.value,\n        salaries: salariesSchedule.value,\n        arrayFill: arrayFill.value,\n      },\n    },\n  }));\n</script>\n\n<template>\n  <div class=\"-m-6 mb-4\">\n    <div class=\"w-full bg-alpha\">\n      <div class=\"flex items-center p-4 border-b\">\n        <h1 class=\"text-2xl font-bold px-3\">Зарплаты</h1>\n      </div>\n    </div>\n  </div>\n  <div class=\"mt-4 mb-6\">\n    <AtTabs\n      :items=\"[\n        { title: 'История зарплаты', value: 'history', icon: 'home', exact: true },\n        { title: 'Запланированная зарплата', value: 'scheduled', icon: 'clipboardList' },\n      ]\"\n      :model-value=\"$route.query.tab\"\n      @update:model-value=\"$router.push({ path: $route.path, query: { tab: $event } })\"\n    />\n  </div>\n  <component\n    v-if=\"dataListValue?.length || arrayFill.length\"\n    :is=\"tabComponents[route.query.tab]?.component || tabComponents.history.component\"\n    v-bind=\"tabComponents[route.query.tab]?.props || tabComponents.history.props\"\n  ></component>\n  <div class=\"mt-2 flex justify-end\">\n    <at-pagination\n      v-if=\"indexPagination.meta?.last_page > 1\"\n      class=\"py-4 md:col-span-1\"\n      v-model=\"query1.page\"\n      :total=\"indexPagination.meta?.last_page\"\n    ></at-pagination>\n  </div>\n</template>\n\n<style scoped></style>\n"],"sourceRoot":""}]}